<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Facilit (Llama 3.3)</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        :root {
            /* Tema Facilit */
            --bg-deep: #050511;
            --glass-surface: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --primary-glow: #4f46e5;
            --accent-glow: #ec4899;
            --gold: #fbbf24;
            --success: #10b981;
            --danger: #ef4444;
            --text-main: #ffffff;
            --text-muted: #94a3b8;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-main);
            margin: 0; height: 100vh;
            display: flex; justify-content: center; overflow: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(79, 70, 229, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(236, 72, 153, 0.15) 0%, transparent 40%);
        }

        .view-section { display: none; flex: 1; flex-direction: column; overflow: hidden; height: 100%; animation: fadeIn 0.3s ease; }
        .view-section.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .login-screen { position: fixed; inset: 0; z-index: 9999; background: var(--bg-deep); display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease; }
        .login-screen.hidden { opacity: 0; pointer-events: none; }
        
        .avatar-glow { width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(45deg, var(--primary-glow), var(--accent-glow)); padding: 4px; cursor: pointer; transition: transform 0.3s; }
        .avatar-glow:active { transform: scale(0.9); }
        .avatar-inner { width: 100%; height: 100%; background: var(--bg-deep); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 3.5rem; }

        .app-layout { width: 100%; max-width: 500px; height: 100%; display: flex; flex-direction: column; position: relative; }
        header { padding: 20px 25px; display: flex; justify-content: space-between; align-items: center; }
        .logo-text { font-weight: 900; font-size: 1.5rem; letter-spacing: -1px; background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .cards-wrapper { display: flex; gap: 15px; padding: 10px 25px; overflow-x: auto; scroll-snap-type: x mandatory; padding-bottom: 20px; cursor: grab; }
        .cards-wrapper:active { cursor: grabbing; }
        .cards-wrapper::-webkit-scrollbar { display: none; }

        .smart-card { min-width: 85%; height: 200px; border-radius: 30px; padding: 25px; position: relative; overflow: hidden; scroll-snap-align: center; display: flex; flex-direction: column; justify-content: space-between; transition: transform 0.3s; user-select: none; }
        .card-wallet { background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%); }
        .card-vault { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .card-analysis { background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%); width: 100%; min-width: 100%; }
        .card-bg-icon { position: absolute; right: -20px; bottom: -20px; font-size: 8rem; opacity: 0.2; transform: rotate(-20deg); }

        .ai-bar-container { margin: 10px 25px 25px 25px; position: relative; }
        .ai-input { width: 100%; padding: 18px 60px 18px 25px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.08); color: white; font-size: 1rem; outline: none; transition: 0.3s; }
        .ai-input:focus { background: rgba(255,255,255,0.15); border-color: var(--accent-glow); box-shadow: 0 0 20px rgba(236, 72, 153, 0.3); }
        .ai-send-btn { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); width: 44px; height: 44px; border-radius: 50%; border: none; background: var(--accent-glow); color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; }

        .list-container { flex: 1; background: var(--glass-surface); border-radius: 40px 40px 0 0; backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-top: 1px solid var(--glass-border); padding: 30px 25px 100px 25px; overflow-y: auto; }
        .transaction-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; padding: 15px; border-radius: 20px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05); }
        .emoji-box { width: 45px; height: 45px; border-radius: 14px; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin-right: 15px; }

        .analysis-content { padding: 25px; overflow-y: auto; padding-bottom: 100px; }
        .ai-message-box { background: rgba(255,255,255,0.05); border: 1px solid var(--accent-glow); border-radius: 20px; padding: 20px; margin-top: 20px; font-size: 0.95rem; line-height: 1.5; color: #e2e8f0; }
        .ai-btn-analyse { width: 100%; padding: 18px; background: linear-gradient(90deg, var(--primary-glow), var(--accent-glow)); border: none; border-radius: 20px; color: white; font-weight: 700; font-size: 1rem; margin-top: 15px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 5px 20px rgba(79, 70, 229, 0.4); }
        .month-stat-row { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid var(--glass-border); }

        .bottom-nav { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(5, 5, 17, 0.9); backdrop-filter: blur(20px); border-top: 1px solid var(--glass-border); display: flex; justify-content: space-around; padding: 15px 0 25px 0; z-index: 100; }
        .nav-item { background: none; border: none; color: var(--text-muted); font-size: 0.75rem; display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; transition: 0.2s; }
        .nav-item.active { color: var(--accent-glow); transform: translateY(-2px); }
        .nav-item i { font-size: 1.4rem; }

        .fab-container { position: absolute; bottom: 85px; right: 25px; z-index: 200; }
        .fab-main { width: 60px; height: 60px; border-radius: 50%; background: var(--text-main); color: var(--bg-deep); border: none; font-size: 1.8rem; box-shadow: 0 10px 30px rgba(255,255,255,0.3); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.2s; }
        .fab-main:active { transform: scale(0.9); }

        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 5000; display: none; align-items: flex-end; }
        .modal-overlay.open { display: flex; }
        .modal-card { background: #1e1e2e; width: 100%; border-radius: 40px 40px 0 0; padding: 35px; animation: slideUp 0.4s; border-top: 1px solid var(--glass-border); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .type-btn { flex: 1; padding: 12px; border: none; background: transparent; color: var(--text-muted); border-radius: 15px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .type-btn.active { background: var(--text-main); color: var(--bg-deep); }
        .type-selector { display: flex; gap: 10px; margin-bottom: 20px; background: rgba(255,255,255,0.05); padding: 5px; border-radius: 20px; }
        input { width: 100%; outline: none; border:none; color:white; background: transparent; }
    </style>
</head>
<body>

    <div id="loginScreen" class="login-screen">
        <h2 style="margin-bottom: 40px; font-weight: 300; letter-spacing: 2px;">QUEM √â VOC√ä?</h2>
        <div style="display:flex; gap: 30px;">
            <div style="text-align:center;">
                <div class="avatar-glow" onclick="logar('Bianca')">
                    <div class="avatar-inner">üë©üèª</div>
                </div>
                <div style="margin-top:15px; font-weight:700;">Bianca</div>
            </div>
            <div style="text-align:center;">
                <div class="avatar-glow" onclick="logar('Beatriz')">
                    <div class="avatar-inner">üë©üèº</div>
                </div>
                <div style="margin-top:15px; font-weight:700;">Beatriz</div>
            </div>
        </div>
    </div>

    <div class="app-layout">
        <header>
            <div class="logo-text">Facilit</div>
            <div onclick="logout()" style="font-size:0.8rem; opacity:0.6; cursor:pointer;">Sair</div>
        </header>

        <div id="view-home" class="view-section active">
            <div class="cards-wrapper">
                <div class="smart-card card-wallet">
                    <i class="fa-solid fa-wallet card-bg-icon"></i>
                    <div>
                        <div style="opacity:0.8; font-size:0.9rem; margin-bottom:5px;">DISPON√çVEL</div>
                        <div style="font-size:2.5rem; font-weight:800; line-height:1;" id="valSaldo">R$ 0,00</div>
                    </div>
                    <div style="background:rgba(0,0,0,0.2); padding:10px 20px; border-radius:20px; width:fit-content;">
                        <i class="fa-solid fa-arrow-trend-up"></i> Carteira
                    </div>
                </div>
                <div class="smart-card card-vault">
                    <i class="fa-solid fa-piggy-bank card-bg-icon"></i>
                    <div>
                        <div style="opacity:0.8; font-size:0.9rem; margin-bottom:5px;">TOTAL GUARDADO</div>
                        <div style="font-size:2.5rem; font-weight:800; line-height:1;" id="valCofre">R$ 0,00</div>
                    </div>
                    <div style="background:rgba(0,0,0,0.2); padding:10px 20px; border-radius:20px; width:fit-content;">
                        <i class="fa-solid fa-lock"></i> Investimentos
                    </div>
                </div>
            </div>

            <div class="ai-bar-container">
                <input type="text" class="ai-input" id="aiPrompt" placeholder="‚ú® IA: 'Gastei 50 no Uber' ou 'Guardei 100'">
                <button class="ai-send-btn" onclick="processarIALancamento()" id="btnIA">
                    <i class="fa-solid fa-paper-plane"></i>
                </button>
            </div>

            <div class="list-container">
                <h4 style="margin-top:0; color:var(--text-muted); font-size:0.8rem; letter-spacing:1px; margin-bottom:20px;">MOVIMENTA√á√ïES</h4>
                <div id="listaMovimentos"></div>
            </div>
            
            <div class="fab-container">
                <button class="fab-main" onclick="abrirModal()">
                    <i class="fa-solid fa-plus"></i>
                </button>
            </div>
        </div>

        <div id="view-analise" class="view-section">
            <div class="analysis-content">
                <h2 style="margin-top:0;">Resumo do M√™s</h2>
                <p style="color:var(--text-muted); font-size:0.9rem;" id="mesAtualLabel">Carregando...</p>
                <div class="smart-card card-analysis" style="height: 160px; margin-bottom:20px;">
                    <i class="fa-solid fa-chart-pie card-bg-icon"></i>
                    <div>
                        <div style="opacity:0.8; font-size:0.9rem;">GASTOS DESTE M√äS</div>
                        <div style="font-size:2.5rem; font-weight:800;" id="gastoMesTotal">R$ 0,00</div>
                    </div>
                </div>
                <div class="month-stat-row">
                    <span>üí∞ Receitas no M√™s</span>
                    <span style="color:var(--success); font-weight:bold;" id="ganhoMesTotal">R$ 0,00</span>
                </div>
                <div class="month-stat-row">
                    <span>üè¶ Guardado no M√™s</span>
                    <span style="color:var(--gold); font-weight:bold;" id="guardadoMesTotal">R$ 0,00</span>
                </div>
                <button class="ai-btn-analyse" onclick="analisarMesComIA()" id="btnAnaliseIA">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> PEDIR CONSELHO DA IA
                </button>
                <div id="aiResponseBox" class="ai-message-box" style="display:none;"></div>
            </div>
        </div>

        <nav class="bottom-nav">
            <button class="nav-item active" onclick="mudarTela('home')" id="nav-home"><i class="fa-solid fa-house"></i> <span>In√≠cio</span></button>
            <button class="nav-item" onclick="mudarTela('analise')" id="nav-analise"><i class="fa-solid fa-chart-simple"></i> <span>An√°lise</span></button>
        </nav>
    </div>

    <div id="modal" class="modal-overlay" onclick="if(event.target === this) fecharModal()">
        <div class="modal-card">
            <h2 style="margin-top:0; margin-bottom:25px;">Novo Lan√ßamento</h2>
            <div class="type-selector">
                <button class="type-btn active" onclick="setTipo('gasto')" id="btn-gasto">üí∏ Gastei</button>
                <button class="type-btn" onclick="setTipo('ganho')" id="btn-ganho">üí∞ Recebi</button>
                <button class="type-btn" onclick="setTipo('reserva')" id="btn-reserva">üè¶ Guardei</button>
            </div>
            <input type="hidden" id="modalTipo" value="gasto">
            <input type="text" id="descInput" placeholder="Descri√ß√£o (Ex: Mercado)" style="width:100%; padding:20px; background:rgba(255,255,255,0.05); border-radius:20px; margin-bottom:15px; font-size:1rem;">
            <input type="number" id="valorInput" placeholder="R$ 0,00" style="width:100%; padding:20px; background:rgba(255,255,255,0.05); border-radius:20px; margin-bottom:25px; font-size:1.5rem; font-weight:bold;">
            <button onclick="salvar()" style="width:100%; padding:20px; background:white; color:black; border:none; border-radius:20px; font-weight:800; font-size:1.1rem; cursor:pointer;">CONFIRMAR</button>
        </div>
    </div>

    <script>
        // --- CONFIGURA√á√ÉO ---
        const SUPABASE_URL = 'https://jaugvxtviorlfmgfwjsv.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_NRFhvTIg3Ji9oR5dV6NjAg_GNy6zAjl';
        
        // --- CHAVE GROQ (J√Å CONFIGURADA) ---
        const GROQ_API_KEY = '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'; 

        // --- SISTEMA ---
        let client;
        try { client = supabase.createClient(SUPABASE_URL, SUPABASE_KEY); } catch (e) { console.error(e); }
        
        let usuarioAtual = '';
        let transacoesCache = [];

        window.onload = () => {
            const user = localStorage.getItem('facilit_user');
            if (user) logar(user);
            enableDragScroll();
            const dataHoje = new Date();
            const nomeMes = dataHoje.toLocaleString('pt-BR', { month: 'long', year: 'numeric' });
            document.getElementById('mesAtualLabel').innerText = nomeMes.charAt(0).toUpperCase() + nomeMes.slice(1);
        }

        function mudarTela(tela) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`view-${tela}`).classList.add('active');
            document.getElementById(`nav-${tela}`).classList.add('active');
        }

        function logar(nome) {
            usuarioAtual = nome;
            localStorage.setItem('facilit_user', nome);
            document.getElementById('loginScreen').classList.add('hidden');
            carregarDados();
        }

        function logout() { localStorage.removeItem('facilit_user'); location.reload(); }

        async function carregarDados() {
            if(!client) return; 
            const { data, error } = await client.from('financas').select('*').order('created_at', { ascending: false });
            if (data) {
                transacoesCache = data;
                renderizarHome(data);
                calcularAnaliseMes(data);
            }
        }

        function renderizarHome(lista) {
            const container = document.getElementById('listaMovimentos');
            container.innerHTML = '';
            let saldo = 0; let cofre = 0;
            lista.forEach(t => {
                // CORRE√á√ÉO: Pula itens com erro ou valor vazio (Evita o 'undefined')
                if (!t.descricao || t.valor === null || isNaN(t.valor)) return;

                const val = parseFloat(t.valor);
                if (t.tipo === 'ganho') saldo += val;
                if (t.tipo === 'gasto') saldo -= val;
                if (t.tipo === 'reserva') { saldo -= val; cofre += val; }

                let emoji = 'üìÑ';
                try {
                    if (t.descricao && t.descricao.match(/[\u{1F300}-\u{1F6FF}]/u)) emoji = t.descricao.match(/[\u{1F300}-\u{1F6FF}]/u)[0];
                } catch(e){}
                const descClean = t.descricao.replace(emoji, '').trim();

                let color = 'white'; let sinal = '';
                if(t.tipo === 'gasto') { color = 'var(--danger)'; sinal = '-'; }
                if(t.tipo === 'ganho') { color = 'var(--success)'; sinal = '+'; }
                if(t.tipo === 'reserva') { color = 'var(--gold)'; sinal = ''; }

                const item = document.createElement('div');
                item.className = 'transaction-row';
                item.innerHTML = `
                    <div style="display:flex; align-items:center;">
                        <div class="emoji-box">${emoji}</div>
                        <div>
                            <div style="font-weight:600;">${descClean}</div>
                            <div style="font-size:0.8rem; opacity:0.6;">${t.quem_lancou} ‚Ä¢ ${new Date(t.created_at).toLocaleDateString()}</div>
                        </div>
                    </div>
                    <div style="font-weight:700; color:${color};">${sinal} R$ ${val.toFixed(2)}</div>
                `;
                container.appendChild(item);
            });
            document.getElementById('valSaldo').innerText = `R$ ${saldo.toFixed(2)}`;
            document.getElementById('valCofre').innerText = `R$ ${cofre.toFixed(2)}`;
        }

        function calcularAnaliseMes(lista) {
            const hoje = new Date();
            const mesAtual = hoje.getMonth();
            const anoAtual = hoje.getFullYear();
            let gastosMes = 0; let ganhosMes = 0; let guardadoMes = 0;
            lista.forEach(t => {
                const dataT = new Date(t.created_at);
                if (dataT.getMonth() === mesAtual && dataT.getFullYear() === anoAtual) {
                    const val = parseFloat(t.valor);
                    if (t.tipo === 'gasto') gastosMes += val;
                    if (t.tipo === 'ganho') ganhosMes += val;
                    if (t.tipo === 'reserva') guardadoMes += val;
                }
            });
            document.getElementById('gastoMesTotal').innerText = `R$ ${gastosMes.toFixed(2)}`;
            document.getElementById('ganhoMesTotal').innerText = `R$ ${ganhosMes.toFixed(2)}`;
            document.getElementById('guardadoMesTotal').innerText = `R$ ${guardadoMes.toFixed(2)}`;
        }

        // --- FUN√á√ÉO AUXILIAR PARA CHAMAR GROQ ---
        async function chamarGroq(promptTexto, isJson = false) {
            const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${GROQ_API_KEY}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    messages: [{ role: "user", content: promptTexto }],
                    model: "llama-3.3-70b-versatile", // MODELO ATUALIZADO E FUNCIONANDO
                    temperature: 0.5,
                    response_format: isJson ? { "type": "json_object" } : undefined
                })
            });

            if (!response.ok) {
                const err = await response.json();
                throw new Error(err.error?.message || "Erro na API Groq");
            }
            const data = await response.json();
            return data.choices[0].message.content;
        }

        // --- IA 1: LAN√áAMENTO (GROQ JSON) ---
        async function processarIALancamento() {
            const txt = document.getElementById('aiPrompt').value;
            const btn = document.getElementById('btnIA');
            if (!txt) return alert("Digite algo!");
            
            btn.innerHTML = '‚è≥';

            const prompt = `
            Analise: "${txt}".
            Retorne APENAS um JSON no formato:
            {
                "descricao": "string",
                "valor": number,
                "tipo": "gasto" (para compras) ou "ganho" (para recebimentos) ou "reserva" (para guardar/cofre),
                "emoji": "um emoji representativo"
            }
            `;

            try {
                const jsonStr = await chamarGroq(prompt, true);
                const json = JSON.parse(jsonStr);

                if (json.tipo === 'reserva') confetti({ particleCount: 100, spread: 70, colors: ['#fbbf24'] });

                await client.from('financas').insert([{
                    descricao: `${json.emoji} ${json.descricao}`, valor: json.valor, tipo: json.tipo, quem_lancou: usuarioAtual
                }]);
                
                document.getElementById('aiPrompt').value = '';
                carregarDados();
            } catch (e) { 
                console.error(e);
                alert(`Erro na IA: ${e.message}`);
            }
            btn.innerHTML = '<i class="fa-solid fa-paper-plane"></i>';
        }

        // --- IA 2: AN√ÅLISE (GROQ TEXTO) ---
        async function analisarMesComIA() {
            const btn = document.getElementById('btnAnaliseIA');
            const box = document.getElementById('aiResponseBox');
            
            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> PENSANDO...';
            box.style.display = 'none';

            const hoje = new Date();
            const itensMes = transacoesCache.filter(t => {
                const d = new Date(t.created_at);
                return d.getMonth() === hoje.getMonth() && d.getFullYear() === hoje.getFullYear() && t.tipo === 'gasto';
            }).map(t => `${t.descricao}: R$${t.valor}`);
            const totalGasto = document.getElementById('gastoMesTotal').innerText;

            const prompt = `
            Voc√™ √© um consultor financeiro. 
            Meus gastos do m√™s deram: ${totalGasto}.
            Lista de gastos: ${itensMes.join(', ').substring(0, 1000)}.
            Me d√™ 3 dicas curtas e pr√°ticas de economia. Use emojis.
            `;

            try {
                const resposta = await chamarGroq(prompt, false);
                box.innerHTML = marked.parse(resposta);
                box.style.display = 'block';
            } catch (e) { alert("Erro ao analisar."); }
            btn.innerHTML = '<i class="fa-solid fa-wand-magic-sparkles"></i> PEDIR CONSELHO DA IA';
        }

        function enableDragScroll() {
            const slider = document.querySelector('.cards-wrapper');
            let isDown = false; let startX; let scrollLeft;
            slider.addEventListener('mousedown', (e) => { isDown=true; slider.style.cursor='grabbing'; startX=e.pageX-slider.offsetLeft; scrollLeft=slider.scrollLeft; });
            slider.addEventListener('mouseleave', () => { isDown=false; slider.style.cursor='grab'; });
            slider.addEventListener('mouseup', () => { isDown=false; slider.style.cursor='grab'; });
            slider.addEventListener('mousemove', (e) => { if(!isDown)return; e.preventDefault(); const x=e.pageX-slider.offsetLeft; const walk=(x-startX)*2; slider.scrollLeft=scrollLeft-walk; });
        }

        function setTipo(t) {
            document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${t}`).classList.add('active');
            document.getElementById('modalTipo').value = t;
        }
        async function salvar() {
            const tipo = document.getElementById('modalTipo').value;
            const desc = document.getElementById('descInput').value;
            const valor = document.getElementById('valorInput').value;
            if(!desc || !valor) return alert("Preencha tudo");
            if(tipo === 'reserva') confetti();
            await client.from('financas').insert([{ descricao: desc, valor: parseFloat(valor), tipo, quem_lancou: usuarioAtual }]);
            fecharModal(); carregarDados();
            document.getElementById('descInput').value = ''; document.getElementById('valorInput').value = '';
        }
        function abrirModal() { document.getElementById('modal').classList.add('open'); }
        function fecharModal() { document.getElementById('modal').classList.remove('open'); }
    </script>
</body>
</html>